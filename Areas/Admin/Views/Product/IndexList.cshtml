
@model IEnumerable<NguyenNhan_2179_tuan3.Models.Product>

@{
    ViewData["Title"] = "Danh Sách Sản Phẩm";
    int numQuantity = 1;
}

<!-- Section chính -->
<section class="py-5 bg-light">
    <div class="container px-4 px-lg-5">
        <!-- Tiêu đề -->
        <div class="text-center mb-5">
            <p class="text-muted fs-5 fst-italic">Khám phá những sản phẩm chất lượng cao và phù hợp với bạn</p>
        </div>

        <!-- Trường hợp không có sản phẩm -->
        @if (!Model.Any())
        {
            <div class="text-center py-5">
                <i class="bi bi-box-seam-fill text-secondary" style="font-size: 4rem;"></i>
                <h4 class="mt-3 text-muted">Chưa có sản phẩm nào</h4>
                <p class="text-muted">Hãy thêm sản phẩm đầu tiên để bắt đầu bán hàng!</p>
            </div>
        }
        else
        {
            <!-- Giao diện bảng DataTable -->
            <h4 class="mb-3"><i class="bi bi-table"></i> Giao diện Bảng Sản Phẩm</h4>
            <div class="table-responsive shadow-sm rounded bg-white p-3 mb-5">
                <table id="productTable" class="table table-hover align-middle">
                    <thead class="table-dark text-center">
                        <tr>
                            <th>Tên</th>
                            <th>Mô tả</th>
                            <th>Giá</th>
                            <th>Hình ảnh</th>
                            <th>Thao tác</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var item in Model)
                        {
                            <tr>
                                <td>@item.Name</td>
                                <td>@Html.Raw(item.Description)</td> <!-- ✅ Cho phép hiển thị HTML từ CKEditor -->
                                <td>@item.Price.ToString("#,##0") VND</td>
                                <td class="text-center">
                                    <img src="@item.ImageUrl" width="100" height="100"
                                         class="img-thumbnail rounded-circle border border-2"
                                         style="object-fit: cover;" />
                                </td>
                                <td class="text-center">
                                    <a asp-controller="ShoppingCart" asp-action="AddToCart"
                                       asp-route-productId="@item.Id"
                                       asp-route-quantity="1"
                                       class="btn btn-sm btn-success mb-1 rounded-pill">
                                        <i class="bi bi-cart-plus-fill"></i> Mua hàng
                                    </a>
                                    <a asp-controller="Home" asp-action="Details" asp-route-id="@item.Id"
                                       class="btn btn-sm btn-outline-primary rounded-pill">
                                        <i class="bi bi-eye-fill"></i> Xem
                                    </a>
                                        <a class="btn btn-outline-warning flex-fill btn-sm"
                                       asp-action="Update" asp-route-id="@item.Id">
                                        <i class="bi bi-pencil me-1"></i>Sửa
                                    </a>
                                    <a class="btn btn-outline-danger flex-fill btn-sm"
                                       asp-action="Delete" asp-route-id="@item.Id"
                                       onclick="return confirm('Bạn có chắc chắn muốn xóa sản phẩm này?')">
                                        <i class="bi bi-trash me-1"></i>Xóa
                                    </a>
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        }
    </div>
</section>

<!-- Script khởi tạo DataTable -->
@section Scripts {
    <script>
        $(document).ready(function () {
            $('#productTable').DataTable({
                responsive: true,
                pageLength: 5,
                lengthMenu: [5, 10, 25, 50],
                language: {
                    search: "🔍 Tìm kiếm:",
                    lengthMenu: "Hiển thị _MENU_ sản phẩm",
                    info: "Đang hiển thị _START_ đến _END_ của _TOTAL_ sản phẩm",
                    paginate: {
                        first: "Đầu",
                        last: "Cuối",
                        next: "▶",
                        previous: "◀"
                    },
                    zeroRecords: "Không tìm thấy sản phẩm phù hợp",
                    infoEmpty: "Chưa có dữ liệu",
                }
            });
        });
    </script>
}
